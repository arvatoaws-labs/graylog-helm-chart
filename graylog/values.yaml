
ingress:
  name: graylog
  enabled: false
  annotations: {}
    # kubernetes.io/ingress.class: nginx
    # kubernetes.io/tls-acme: "true"
  tls: []
  #  - secretName: chart-example-tls
  #    hosts:
  protocol: https
  domain: local

mongodb:
  name: mongodb
  usePassword: true
  mongodbDatabase: graylog
  mongodbUsername: graylog
  mongodbPassword: secret
  metrics:
    enabled: true
    serviceMonitor:
      enabled: true
      additionalLabels: 
        release: prometheus

  replicaSet:
    enabled: true

elasticsearch:
  name: elasticsearch
  appVersion: "5.6.4"
  
  image:
    repository: "docker.elastic.co/elasticsearch/elasticsearch"
    tag: "5.6.4"

  cluster:
    xpackEnable: false
    env:
      xpack.security.enabled: 'false'
      XPACK_MONITORING_ENABLED: 'false'

  client:
    replicas: 2

  master:
    replicas: 3
    persistence:
      size: "4Gi"
      storageClass: "gp2"

  data:
    replicas: 2
    persistence:
      size: "500Gi"
      storageClass: "st1"

elasticsearch-exporter:
  es:
    uri: "http://graylog-elasticsearch-client:9200"

graylog:
  name: graylog
  appVersion: 2.4.6

  image:
    repository: "arvatoaws/graylog"
    tag: "latest"

#  rootUsername: admin
#  rootPassword:
#  passwordSecret:
  
  storageClass: "gp2"
  storageSize: "10Gi"

  web:
    service:
      externalPort: 80
      internalPort: 9000

  master:
    name: master
    replicaCount: 1

    affinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchExpressions:
              - key: component
                operator: In
                values:
                - graylog-slave
            topologyKey: kubernetes.io/hostname

    containers:
      resources:
        requests:
          cpu: 1
          memory: 1536Mi
        limits:
          cpu: 1.5
          memory: 2048Mi

  slave:
    name: slave
    replicaCount: 2

    affinity:
      podAntiAffinity:
        requiredDuringSchedulingIgnoredDuringExecution:
        - labelSelector:
            matchExpressions:
            - key: component
              operator: In
              values:
              - graylog-master
          topologyKey: kubernetes.io/hostname

    containers:
      resources:
        requests:
          cpu: 1
          memory: 1536Mi
        limits:
          cpu: 1.5
          memory: 2048Mi
